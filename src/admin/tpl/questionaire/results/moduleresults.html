{% extends "questionaire/questionaire.html" %}

{% set title = "Modules" %}

{% block javascripts %}
	{{ parent() }}
	
	<script src="{{url}}/js/Chart.min.js" type="text/javascript"></script>
	<script type="text/javascript">
		function doChart(key, data) {
			doBarChart(key+"_bar", data);
			doPieChart(key+"_pie", data);
		}
		
		function doBarChart(key, data) {
			var graphdata = {
				"labels": [1,2,3,4,5],
				"datasets":[
					{
						"value":0,
						"color":"#F7464A",
						"data":data
					}
				]
			}
			
			var ctx = document.getElementById(key).getContext("2d");
			var myNewChart = new Chart(ctx).Bar(graphdata);
		}
		
		function doPieChart(key, data) {
			var graphdata = [
				{
					"value": data[0],
					"color": "#FF0000",
					"label": "1"
				},
				{
					"value": data[1],
					"color": "#FF7700",
					"label": "2"
				},
								{
					"value": data[2],
					"color": "#FFFF00",
					"label": "3"
				},
								{
					"value": data[3],
					"color": "#88FF00",
					"label": "4"
				},
								{
					"value": data[4],
					"color": "#00FF00",
					"label": "5"
				},
			]
			
			var ctx = document.getElementById(key).getContext("2d");
			var myNewChart = new Chart(ctx).Pie(graphdata);
		}
	</script>
{% endblock %}

{% block qcontent %}
	{% for alert in alerts %}
		<div class="alert alert-{{alert.type}}" role="alert">{{alert.message}}</div>
	{% endfor %}
	
	<h1>Results for {{module.ModuleID}}: {{module.ModuleTitle}}</h1>
	

	{% for question in questions %}
		<h3>{{question.QuestionText}}</h3>
		
		{% if question.QuestionType == "text" %}
			{% for result in question.Results %}
				{{result.Value}}<br/>
			{% endfor %}
		{% elseif question.QuestionType == "rate" %}
		<canvas id="{{question.Key}}_bar" width="400" height="400"></canvas>
		<canvas id="{{question.Key}}_pie" width="400" height="400"></canvas>
		<script>
			doChart("{{question.Key}}",{{question.Summary|json_encode()}});
		</script>
		{% endif %}
		
	{% endfor %}

{% endblock %}
